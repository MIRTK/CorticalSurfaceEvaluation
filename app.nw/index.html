<!DOCTYPE html>
<html lang="en">
  <head>
    <meta content="text/html; charset=windows-1252" http-equiv="content-type">
    <title>Cortical Surface Evaluation</title>
    <link href="../node_modules/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="app.css" rel="stylesheet">
  </head>
  <body data-feedly-mini="yes">
    <nav class="navbar navbar-dark bg-inverse">
      <div class="nav navbar-nav">
        <a class="nav-item nav-link" href="#" id="nav-help">Help</a>
        <a class="nav-item nav-link active" href="#" id="nav-open">Tasks</a>
      </div>
    </nav>
    <div id="alerts">

    </div>
    <div role="main" id="container">
      
    </div>

    <!-- Template: Help page -->
    <template id="helpTemplate">
      <div id="help" class="container theme-showcase">
      <div class="jumbotron">
        <h1>Cortical Surface Evaluation</h1>
        <p>
          App for manual evaluation of the automatically reconstructed cortical surfaces.
        </p>
      </div>
      <h4>Thank you!</h4>
      <p>
        Thanks for volunteering to evaluate the reconstructed surfaces!
      </p>
      <p>
        Please use this application to record your assessment in the provided database file.
        This file usually has a <code>.db</code> file name extension, e.g., <mark>recon-neonatal-cortex.db</mark>.
      </p>
      <p>
        There are two different types of evaluation tasks. The first is to assign quality scores given
        a screenshot taken from a render of a subregion of the MR brain volume overlaid with exactly
        one cortical surface contour. The second type of task is the comparison two cortical surface
        contours produced by different algorithms. For more details regarding each of these tasks,
        see the two sections below.
      </p>
      <p>
        Note that scores are recorded in the database as soon as a button is clicked or when the
        key on your keyboard corresponding to your rating is released again. You can take a break at
        any point, keep the application window in the background, or close it and open again later.
        Your progress is shown on the "Tasks" page and in the top right corner of each task.
      </p>
      <p>
        Once you have read the help below, switch to the "Tasks" page and start with "Task 1".
      </p>

      <h4>Task 1: Rate quality of individual contours</h4>
      <p>
        The first task is to rate the accuracy with which a given reconstructed cortical surface delineates the
        true boundary between white matter and cortical grey matter. For each brain scan, you will be presented
        with a number of screenshots taken from regions of interest (ROIs) that have been pre-selected either
        based on quantitative criteria such as considerable disagreement between tissue segmentation and reconstructed
        surface or been chosen randomly. In total, there are three orthogonal screenshots from each ROI with
        the same voxel at the center of the field of view.
      </p>
      <figure class="center-text">
        <img src="assets/evaluate-accuracy.png" alt="Example screenshot of evaluation task" />
        <figcaption>
          Figure 1: Example screenshot of the evaluation interface of task 1.
        </figcaption>
      </figure>
      <p>
        Note that the surface contours may correspond to either one of the cortical surface reconstructed
        with one of the algorithms that are being compared against each other in this evaluation study.
        After each rating, you will be presented with a new screenshot randomly chosen from all screenshots
        taken from any of the MR brain scans included in the study and with any of the surface contours overlaid.
      </p>
      <p>
        Your task is to assign one of the scores listed below by clicking the corresponding button below the
        screenshots, or by pressing the respective key on your keyboard. A brief description of the meaning of
        each score and when to assign it is given below.
        <table class="table borderless" id="help-scores">
          <tbody>
            <tr>
              <td><button class="btn btn-sm btn-block btn-danger" id="test-score-0">0-<strong>D</strong>iscard [down]</button></td>
              <td>Screenshot insufficient to assess quality (e.g., background).</td>
            </tr>
            <tr>
              <td><button class="btn btn-sm btn-block btn-warning" id="test-score-1">1-<strong>P</strong>oor [left]</button></td>
              <td>Contour substantially deviates from tissue boundary.</td>
            </tr>
            <tr>
              <td><button class="btn btn-sm btn-block btn-info" id="test-score-2">2-<strong>F</strong>air [up]</button></td>
              <td>Contour close, but mainly not within sub-pixel accuracy.</td>
            </tr>
            <tr>
              <td><button class="btn btn-sm btn-block btn-primary" id="test-score-3">3-<strong>G</strong>ood [right]</button></td>
              <td>Contour for the most part correct, with only minor irregularities.</td>
            </tr>
          </tbody>
        </table>
        You can enter the scores by either clicking the respective button, or pressing the key on your keyboard
        corresponding to the numeric score value, e.g., "2" for "Fair", or by pressing the key corresponding to
        the first bold highlighted letter of the corresponding verbal score, i.e., "f" for "Fair" and "g" for "Good".
        Alternatively, use the arrow keys indicated in square brackets, i.e., press the right arrow key to
        assign the score "Good".
      </p>
      <div class="card">
        <div class="card-header" style="background-color: #ffffbb; border-color: #ffffbb;">
          Discarding screenshots
        </div>
        <div class="card-block">
          When you discard a screenshot as not being suitable to assess the quality of the
          surface contours, all screenshots with the same field of view from this zoomed in
          region of interest that were not rated yet are discarded as well. Morover,
          screenshots for the comparison of two surface contours in the other tasks 
          taken from the same ROI are then also excluded from these tasks.
        </div>
      </div>
      <div class="card">
        <div class="card-header" style="background-color: #ffffbb; border-color: #ffffbb;">
          Note
        </div>
        <div class="card-block">
          Contours of a surface intersected by an image slice may appear to not be
          close to the tissue boundary in one view, but be nearer in a slice slightly above or below
          the one shown. This is mainly the case where the direction of the gyrus goes out of plane
          which sometimes can be seen from the intensity images. Where there is a clear tissue boundary
          between white matter and cortical grey matter and the cortex has locally near constant
          thickness, this is unlikely the case and the contour should be close to the tissue boundary.
        </div>
      </div>

      <h4>Task 2/3: Which one is better?</h4>
      <p>
        In the second and third task, you are shown volume slice renders with two different cortical surfaces
        obtained using different methods for cortical surface reconstruction. The two contours are
        of the surfaces intersected with the respective image plane are shown with different colors.
        To be able to distinguish contours that are present in either both, i.e., only one contour
        is visible in the comparison view the other is occluded, or only one of the surfaces,
        there are three screenshots shown: a comparison view with both contours overlaid and
        two separate screenshots with only one of the two contours shown in each.
      </p>
      <figure class="center-text">
        <img src="assets/compare-contours.png" alt="Example screenshot of comparison task" />
        <figcaption>
          Figure 2: Example screenshot of the comparison interface of tasks 2 and 3.
        </figcaption>
      </figure>
      <p>
        Your task is to choose which of the two differently colored contours depicts the true tissue
        boundary seen in the MR image more accurately by pressing either the button labeled "A" or
        the button labeled "B", depending on which button has the color of your choicen contour.
        When both contours delineate the boundary either perfectly well or contain comparable
        errors, please choose the option "Neither".
      </p>
      <p>
        You can enter your choice either by clicking the respective button or by pressing the key
        on your keyboard corresponding to your choice, i.e., "a" for choice A, "b" for choice B,
        and "n" for neither choice. Alternativley, use left arrow for choice A, the right arrow
        for choice B, and the down/up arrow for neither choice.
      </p>
      <div class="card">
        <div class="card-header" style="background-color: #ffffbb; border-color: #ffffbb;">
          Note
        </div>
        <div class="card-block">
          The color of each contour and the assignment of a surface to choice "A" or "B",
          respectively, is picked randomly each time. This is to avoid bias in your choice.
          Please, inspect the images carefully before choosing, "A", "B", or "Neither".
        </div>
      </div>

      </div>
    </template>

    <!-- Template: Open database and task overview -->
    <template id="openTemplate">
      <div class="container theme-showcase">
      <div class="jumbotron">
        <h1>Cortical Surface Evaluation</h1>
        <ol>
          <li>
            Read the instructions on the <a href="#" onclick="showPage('help');"">Help</a> page if this your first time.
          </li>
          <li>
            <a href="#" onclick="chooseDatabase('#dbFile')">Open database</a> file with details of tasks and recorded scores.
          </li>
          <li>
            Enter your email address and assigned password.
          </li>
          <li>
            Click on a task link to continue rating the contours.
          </li>
          <li>
            When task complete, <a id="mail" href="#">send database file</a> to <span class="contact"></span>.
          </li>
        </ol>
      </div>
      <div id="summary" class="collapse">
        <table class="table">
          <thead class="thead-inverse">
            <tr>
              <th>Task</th>
              <th>Total</th>
              <th>To-Do</th>
              <th>Done</th>
            </tr>
          </thead>
          <tbody>
            <tr class="eval" id="task1">
              <th scope="row"><button id="task1-link" class="btn btn-link">Task 1</button></th>
              <td class="total">N/A</td>
              <td class="remaining">N/A</td>
              <td><span class="done">N/A</span></td>
            </tr>
            <tr class="comp" id="task2">
              <th scope="row"><button id="task2-link" class="btn btn-link">Task 2</button></th>
              <td class="total">N/A</td>
              <td class="remaining">N/A</td>
              <td><span class="done">N/A</span></td>
            </tr>
            <tr class="comp" id="task3">
              <th scope="row"><button id="task3-link" class="btn btn-link">Task 3</button></th>
              <td class="total">N/A</td>
              <td class="remaining">N/A</td>
              <td><span class="done">N/A</span></td>
            </tr>
          </tbody>
        </table>
      </div>
      <form id="chooseDatabase" style="display:none;">
        <input style="display:none;" id="dbFile" type="file" accept=".db" nwworkingdir="."/>
      </form>
      <form id="loginForm" class="collapse">
        <p>Sign in with your registered email address and the password that was sent to this address.</p>
        <div class="form-group">
          <label for="raterEmail">Email address</label>
          <input class="form-control" id="raterEmail" aria-describedby="emailHelp" placeholder="Enter email" type="email">
          <small id="emailHelp" class="form-text text-muted">Your email address at which you received the password.</small>
        </div>
        <div class="form-group">
          <label for="raterPassword">Password</label>
          <input class="form-control" id="raterPassword" placeholder="Password" type="password">
        </div>
        <button type="submit" class="btn btn-primary">Sign in</button>
      </form>
      </div>
    </template>

    <!-- Template: Surface evaluation -->
    <template id="evalTemplate">
      <div class="eval collapse">
        <div class="center-text" id="progress">
          <strong><span class="remaining"></strong> remaining<span style="display: none"> out of <span class="total"></span></span>,
          you've rated <span class="done"></span>!
        </div>
        <div id="screenshots" class="center-text">
          <figure id="roi-bounds-view">
            <img />
          </figure>
          <figure id="zoomed-roi-view">
            <img />
          </figure>
        </div>
        <div id="scores">
          <div class="btn-toolbar score-toolbar">
            <button id="score-1" type="button" class="btn btn-warning">1-<strong>P</strong>oor [left]</button>
            <button id="score-2" type="button" class="btn btn-info">2-<strong>F</strong>air [up]</button>
            <button id="score-3" type="button" class="btn btn-primary">3-<strong>G</strong>ood [right]</button>
          </div>
          <div class="btn-toolbar score-toolbar">
            <button id="score-0" type="button" class="btn btn-default">0-<strong>D</strong>iscard [down]</button>
          </div>
        </div>
      </div>
    </template>

    <!-- Template: Comparison of two surfaces -->
    <template id="compTemplate">
      <div class="comp collapse">
        <div class="center-text" id="progress">
          <strong><span class="remaining"></strong> remaining<span style="display: none"> out of <span class="total"></span></span>,
          you've rated <span class="done"></span>!
        </div>
        <div id="screenshots" class="center-text">
          <div>
            <figure id="roi-bounds-view">
              <img />
            </figure>
            <figure id="zoomed-roi-view">
              <img />
            </figure>
          </div>
          <div>
            <figure id="overlay1-view">
              <img />
            </figure>
            <figure id="overlay2-view">
              <img />
            </figure>
          </div>
        </div>
        <div id="choice" class="btn-toolbar choice-toolbar">
          <button id="choice-0" type="button" class="btn"><strong>A</strong> [left]</button>
          <button id="choice-2" type="button" class="btn btn-default"><strong>N</strong>either [down]</button>
          <button id="choice-1" type="button" class="btn"><strong>B</strong> [right]</button>
        </div>
      </div>
    </template>

    <!-- Template: Miscellaneous -->
    <template id="errorTemplate">
      <div class="alert alert-danger alert-dismissible fade in" role="alert" id="msgBox">
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
        <p id="msg"></p>
      </div>
    </template>

    <template id="successTemplate">
      <div class="alert alert-success" role="alert" id="msgBox">
        <p id="msg"></p>
      </div>
    </template>

    <!-- Scripts -->
    <script src="../node_modules/jquery/dist/jquery.min.js"></script>
    <script src="../node_modules/tether/dist/js/tether.min.js"></script>
    <script src="../node_modules/bootstrap/dist/js/bootstrap.min.js"></script>
    <script src="app.js"></script>
  </body>
</html>
