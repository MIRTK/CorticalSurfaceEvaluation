<!DOCTYPE html>
<html lang="en">
  <head>
    <meta content="text/html; charset=windows-1252" http-equiv="content-type">
    <title>Cortical Surface Evaluation</title>
    <link href="../node_modules/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="app.css" rel="stylesheet">
  </head>
  <body data-feedly-mini="yes">
    <nav class="navbar navbar-dark bg-inverse">
      <div class="nav navbar-nav">
        <a class="nav-item nav-link" href="#" id="nav-help">Help</a>
        <a class="nav-item nav-link active" href="#" id="nav-open">Tasks</a>
      </div>
    </nav>
    <div id="alerts">

    </div>
    <div role="main" id="container">
      
    </div>

    <!-- Template: Help page -->
    <template id="helpTemplate">
      <div class="container theme-showcase">
      <div class="jumbotron">
        <h1>Cortical Surface Evaluation</h1>
        <p>
          App for manual evaluation of the automatically reconstructed cortical surfaces.
        </p>
      </div>
      <h4>Thank you!</h4>
      <p>
        Thanks for volunteering to evaluate the reconstructed surfaces!
      </p>
      <p>
        Please use this application to record your scores in the provided database file which you find in the
        top-level directory of the archive that also contained this application. The file has a <code>.db</code>
        extension and should be named <mark>recon-neonatal-cortex.db</mark>.
      </p>
      <p>
        There are two evaluation tasks detailed below. Note that your scores are recorded in the database
        as soon as a button with your rating is pressed. You can take a break at any point, keep the
        application window in the background, or close it and open again later.
      </p>
      <p>
        Your progress is shown on the "Tasks" page and in the top right corner of each task.
      </p>

      <h4>Task 1: Rate quality of individual contours</h4>
      <p>
        The first task is to rate the accuracy with which a given reconstructed surface delineates the
        true boundary between white matter and cortical grey matter. For each brain scan, you will be presented
        with a number of screenshots taken from small regions of interest (ROIs) that have been pre-selected either
        based on quantitative criteria such as considerable disagreement between tissue segmentation and reconstructed
        surface or been chosen randomly. For each ROI, you are shown three orthogonal slices of the T2-weighted
        brain MR volume with the contour of the reconstructed surface cut by the corresponding image plane overlayed.
        Note that the surface contours may correspond to either the initial surface reconstructed from the
        tissue segmentation alone, or the final reonstructed white matter surface. Which one is shown at a time
        is chosen randomly and both contours are visualised in the same color. This is to avoid bias in the
        evaluation towards either of the two surfaces.
      </p>
      <p>
        Your task is to assign one of the scores listed below by clicking the corresponding button below the
        screenshots. A brief description of the meaning of each score and when to assign it is given below.
        <table class="table borderless" id="help-scores">
          <tbody>
            <tr>
              <td><button class="btn btn-sm btn-block btn-danger" id="test-score-1">1-<strong>B</strong>ad</button></td>
              <td>Contour follows random, noisy, or other tissue edge.</td>
            </tr>
            <tr>
              <td><button class="btn btn-sm btn-block btn-warning" id="test-score-2">2-<strong>P</strong>oor</button></td>
              <td>Contour substantially deviates from tissue boundary.</td>
            </tr>
            <tr>
              <td><button class="btn btn-sm btn-block btn-info" id="test-score-3">3-<strong>F</strong>air</button></td>
              <td>Contour close, but mainly not within sub-pixel accuracy.</td>
            </tr>
            <tr>
              <td><button class="btn btn-sm btn-block btn-primary" id="test-score-4">4-<strong>G</strong>ood</button></td>
              <td>Contour for the most part correct, but with minor irregularities.</td>
            </tr>
            <tr>
              <td><button class="btn btn-sm btn-block btn-success" id="test-score-5">5-<strong>E</strong>xcellent</button></td>
              <td>Contour depicts tissue boundary within sub-pixel accuracy.</td>
            </tr>
          </tbody>
        </table>
        You can enter the scores by either clicking the respective button, or pressing the key on your keyboard
        corresponding to the numeric score value, e.g., "3" for "Fair", or by pressing the key corresponding to
        the first bold highlighted letter of the corresponding verbal score, i.e., "f" for "Fair" and "e" for "Excellent".
        The labels of the buttons also indicate these corresponding keys.
      </p>
      <div class="card">
        <div class="card-header" style="background-color: #ffffbb; border-color: #ffffbb;">
          Note
        </div>
        <div class="card-block">
          Contours of a surface intersected by an image slice may appear to not be
          close to the tissue boundary in one view, but be nearer in a slice slightly above or below
          the one shown. This is mainly the case where the direction of the gyrus goes out of plane
          which sometimes can be seen from the intensity images. Where there is a clear tissue boundary
          between white matter and cortical grey matter and the cortex has locally near constant
          thickness, this is unlikely the case and the contour should be close to the tissue boundary.
        </div>
      </div>

      <h4>Task 2: Which one is better?</h4>
      <p>
        In this task you are shown volume slice renders with both surfaces overlayed with different colors.
        The task is to choose which of the two contours depicts the true tissue boundary seen in
        the MR image better by pressing either the button labeled "A" or the button labeled "B",
        depending on the color of the button which corresponds to the color of the contour in the
        images that best depicts the tissue boundary.
        When both surfaces either delineate the boundary perfectly well or contain comparable
        errors, please choose the option "Neither".
      </p>
      <p>
        You can enter your scores either by clicking the respective button or by pressing the key
        on your keyboard corresponding to your choice, i.e., "a" for choice A, "b" for choice B,
        and "n" for neither choice. Alternativley, use the arrow keys instead: left arrow for choice A,
        right arrow for choice B, and down/up arrow for neither choice. The labels of the buttons
        also indicate these corresponding keys.
      </p>
      <div class="card">
        <div class="card-header" style="background-color: #ffffbb; border-color: #ffffbb;">
          Note
        </div>
        <div class="card-block">
          The colors of the contours are picked randomly each time. Also the choice of "A" and "B",
          respectively, is randomly assigned to either one of the two contours.
          This is to avoid bias to always vote for choice "A" or "B", respectively.
          Inspect the images carefully before making a choice.
        </div>
      </div>
      </div>
    </template>

    <!-- Template: Open database and task overview -->
    <template id="openTemplate">
      <div class="container theme-showcase">
      <div class="jumbotron">
        <h1>Cortical Surface Evaluation</h1>
        <ol>
          <li>
            Read the instructions on the <a href="#" onclick="showPage('help');"">Help</a> page if this your first time.
          </li>
          <li>
            <a href="#" onclick="chooseDatabase('#dbFile')">Open database</a> file with details of tasks and recorded scores.
          </li>
          <li>
            Enter your email address and assigned password.
          </li>
          <li>
            Click on a task link to continue rating the contours.
          </li>
          <li>
            When task complete, <a id="mail" href="#">send database file</a> to <span class="contact"></span>.
          </li>
        </ol>
      </div>
      <div id="summary" class="collapse">
        <table class="table">
          <thead class="thead-inverse">
            <tr>
              <th>Task</th>
              <th>Total</th>
              <th>To-Do</th>
              <th>Done</th>
            </tr>
          </thead>
          <tbody>
            <tr class="eval" id="eval">
              <th scope="row"><button class="btn btn-link">Task 1</button></th>
              <td class="total">N/A</td>
              <td class="remaining">N/A</td>
              <td><span class="done">N/A</span></td>
            </tr>
            <tr class="comp" id="comp">
              <th scope="row"><button class="btn btn-link">Task 2</button></th>
              <td class="total">N/A</td>
              <td class="remaining">N/A</td>
              <td><span class="done">N/A</span></td>
            </tr>
          </tbody>
        </table>
      </div>
      <form id="chooseDatabase" style="display:none;">
        <input style="display:none;" id="dbFile" type="file" accept=".db" nwworkingdir="."/>
      </form>
      <form id="loginForm" class="collapse">
        <p>Sign in with your registered email address and the password that was sent to this address.</p>
        <div class="form-group">
          <label for="raterEmail">Email address</label>
          <input class="form-control" id="raterEmail" aria-describedby="emailHelp" placeholder="Enter email" type="email">
          <small id="emailHelp" class="form-text text-muted">Your email address at which you received the password.</small>
        </div>
        <div class="form-group">
          <label for="raterPassword">Password</label>
          <input class="form-control" id="raterPassword" placeholder="Password" type="password">
        </div>
        <button type="submit" class="btn btn-primary">Sign in</button>
      </form>
      </div>
    </template>

    <!-- Template: Surface evaluation -->
    <template id="evalTemplate">
      <div class="eval collapse" id="eval">
        <div class="center-text" id="progress">
          <strong><span class="remaining"></strong> remaining<span style="display: none"> out of <span class="total"></span></span>,
          you've rated <span class="done"></span>!
        </div>
        <div id="screenshots" class="center-text">
          <figure id="roi-bounds-view">
            <img />
          </figure>
          <figure id="zoomed-roi-view">
            <img />
          </figure>
        </div>
        <div id="scores">
          <div class="btn-toolbar score-toolbar">
            <button id="score-1" type="button" class="btn btn-warning">1-<strong>P</strong>oor [left]</button>
            <button id="score-2" type="button" class="btn btn-info">2-<strong>F</strong>air [up]</button>
            <button id="score-3" type="button" class="btn btn-primary">3-<strong>G</strong>ood [right]</button>
          </div>
          <div class="btn-toolbar score-toolbar">
            <button id="score-0" type="button" class="btn btn-default">0-<strong>D</strong>iscard [down]</button>
          </div>
        </div>
      </div>
    </template>

    <!-- Template: Comparison of two surfaces -->
    <template id="compTemplate">
      <div class="comp collapse" id="comp">
        <div class="center-text" id="progress">
          <strong><span class="remaining"></strong> remaining<span style="display: none"> out of <span class="total"></span></span>,
          you've rated <span class="done"></span>!
        </div>
        <div id="screenshots" class="center-text">
          <div>
            <figure id="roi-bounds-view">
              <img />
            </figure>
            <figure id="zoomed-roi-view">
              <img />
            </figure>
          </div>
          <div>
            <figure id="overlay1-view">
              <img />
            </figure>
            <figure id="overlay2-view">
              <img />
            </figure>
          </div>
        </div>
        <div id="choice" class="btn-toolbar choice-toolbar">
          <button id="choice-0" type="button" class="btn"><strong>A</strong> [left]</button>
          <button id="choice-2" type="button" class="btn btn-default"><strong>N</strong>either [down]</button>
          <button id="choice-1" type="button" class="btn"><strong>B</strong> [right]</button>
        </div>
      </div>
    </template>

    <!-- Template: Miscellaneous -->
    <template id="errorTemplate">
      <div class="alert alert-danger alert-dismissible fade in" role="alert" id="msgBox">
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
        <p id="msg"></p>
      </div>
    </template>

    <template id="successTemplate">
      <div class="alert alert-success" role="alert" id="msgBox">
        <p id="msg"></p>
      </div>
    </template>

    <!-- Scripts -->
    <script src="../node_modules/jquery/dist/jquery.min.js"></script>
    <script src="../node_modules/tether/dist/js/tether.min.js"></script>
    <script src="../node_modules/bootstrap/dist/js/bootstrap.min.js"></script>
    <script src="app.js"></script>
  </body>
</html>
